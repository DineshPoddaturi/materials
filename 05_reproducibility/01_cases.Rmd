---
title: "Stat 585 - Case Studies in Failed Reproducibility"
author: "Heike Hofmann"
ratio: 16x10
output:
  rmdshower::shower_presentation:
    self_contained: false
    katex: true
    theme: ribbon
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Reproducibility of Research

## Source

Material for this slide deck comes from 

- Data Carpentry repository [rr-intro](https://github.com/datacarpentry/rr-intro)   (Jenni Bryan and Mine Çetinkaya-Rundel) 
- Data Carpentry repository [rr-organization1](https://github.com/datacarpentry/rr-organization1) (Ciera Martinez)

## Science retracts gay marriage paper without agreement of lead author

- May 2015: Science retracts paper of how canvassers can sway people's opinions about 
gay marriage.
- Science Editor-in-Chief: Original survey data not made available for independent
reproduction of results + Survey incentives misrepresented + Sponsorship 
statement false
- Two Berkeley grad students attempted to replicate the study and discovered that 
the data must have been faked.
- Outright fraud cannot be prevented by reproducibility methods, but the methods  make it easier to discover such issues.

<small>
Source: 
http://news.sciencemag.org/policy/2015/05/science-retracts-gay-marriage-paper-without-lead-author-s-consent
</small>


## Seizure study retracted after authors realize data got "terribly mixed"

From the authors of **Low Dose Lidocaine for Refractory Seizures in Preterm Neonates**:

*"The article has been retracted at the request of the authors. After carefully 
re-examining the data presented in the article, they identified that data of two 
different hospitals got terribly mixed. The published results cannot be reproduced in
accordance with scientific and clinical correctness."*

<small>
Source: http://retractionwatch.com/2013/02/01/seizure-study-retracted-after-authors-realize-data-got-terribly-mixed/
</small>


## Bad spreadsheet merge kills depression paper, quick fix resurrects it

- The authors informed the journal that the merge of lab results and other survey 
data used in the paper resulted in an error regarding the identification codes.
- **Original conclusion:** Lower levels of CSF IL-6 were associated with current 
depression and with future depression [...].
- **Revised conclusion:** Higher levels of CSF IL-6 and IL-8 were associated with 
current depression [...].

<small>
Source: 
http://retractionwatch.com/2014/07/01/bad-spreadsheet-merge-kills-depression-paper-quick-fix-resurrects-it/
</small>

## Keith Baggerly: Founder of "Bioinformatic Forensics"

- Start of the so-called *Potti retractions*: http://videolectures.net/cancerbioinformatics2010_baggerly_irrh/
- by now Anil Potti was forced to retract four papers
- Five cancer drug studies exhibited "several simple errors" [Annals of Applied Statistics 2009](http://projecteuclid.org/euclid.aoas/1267453942) (mislabeling, row/column offsets) to the point that the exact opposite drug was given to participants resulting in likely avoidable deaths.

# What can/should we do?

## Four facets of reproducibility

1. **Documentation:** avoid binary files (e.g. docx) and use text files for documentation
    - Use markdown to document your workflow so that anyone can pick up your
    data and follow what you are doing
    - Use literate programming so that your analysis and your results are
    tightly connected, or better yet, unseparable
2. **Organization:** tools to organize your projects so that you don't have a single folder with hundreds of files
3. **Automation:** the power of scripting to create automated data analyses
4. **Dissemination:** publishing is not the end of your analysis, rather it is a way 
station towards your future research and the future research of others

# File Organization

## Names matter

What works, what doesn't?

**NO**

~~~
myabstract.docx
Joe’s Filenames Use Spaces and Punctuation.xlsx
figure 1.png
fig 2.png
JW7d^(2sl@deletethisandyourcareerisoverWx2*.txt
~~~

**YES**

~~~
2014-06-08_abstract-for-sla.docx
joes-filenames-are-getting-better.xlsx
fig01_scatterplot-talk-length-vs-interest.png
fig02_histogram-talk-attendance.png
1986-01-28_raw-data-from-challenger-o-rings.txt
~~~

## Three principles for (file) names

1. Machine readable
2. Human readable
3. Plays well with default ordering

## Awesome file names :)

![awesome_names](img/01-naming/awesome_names.png)

# Machine readable

## Machine readable

- Regular expression and globbing friendly
    + Avoid spaces, punctuation, accented characters, case sensitivity
- Easy to compute on
    + Deliberate use of delimiters
    
## Globbing

**Excerpt of complete file listing:**

![plasmid_names](img/01-naming/plasmid_names.png)

<hr>

**Example of globbing to narrow file listing:**

![plasmid_names](img/01-naming/plasmid_glob.png)


## Same using Mac OS Finder search facilities

<center>
![plasmid_mac_os_search](img/01-naming/plasmid_mac_os_search.png)
</center>

## Same using regex in R

<center>
![plasmid_regex](img/01-naming/plasmid_regex.png)
</center>

## Punctuation {.smaller}

Deliberate use of `"-"` and `"_"` allows recovery of meta-data from the filenames:

- `"_"` underscore used to delimit units of meta-data I want later
- `"-"` hyphen used to delimit words so my eyes don't bleed

<center>
![plasmid_delimiters](img/01-naming/plasmid_delimiters.png)
</center>

<hr>

<center>
![plasmid_delimiters_code](img/01-naming/plasmid_delimiters_code.png)
</center>

This happens to be R but also possible in the shell, Python, etc.

## Recap: machine readable

- Easy to search for files later
- Easy to narrow file lists based on names
- Easy to extract info from file names, e.g. by splitting
- New to regular expressions and globbing? be kind to yourself and avoid
    + Spaces in file names
    + Punctuation
    + Accented characters
    + Different files named `foo` and `Foo`
    
# Human readable

## Human readable

- Name contains info on content
- Connects to concept of a *slug* from semantic URLs

## Example

**Which set of file(name)s do you want at 3 a.m. before a deadline?**

![human_readable_not_options](img/01-naming/human_readable_not_options.png)

## Embrace the slug

<div class="columns-2">
![slug_filenames](img/01-naming/slug_filenames.png)
![slug](img/01-naming/slug.jpg)
</div>

Human readability: Easy to figure out what the heck something is, based on its name

# Plays well with default ordering

## Plays well with default ordering

- Put something numeric first
- Use the ISO 8601 standard for dates
- Left pad other numbers with zeros

## Examples

**Chronological order:**

![chronological_order](img/01-naming/chronological_order.png)

<hr>

**Logical order:** Put something numeric first

![logical_order](img/01-naming/logical_order.png)

## Dates

Use the ISO 8601 standard for dates: YYYY-MM-DD

![chronological_order](img/01-naming/chronological_order.png)

##

<center>
![iso_psa](https://imgs.xkcd.com/comics/iso_8601.png)
</center>

xkcd comic [#1179](https://xkcd.com/1179/)

## Comprehensive map of all countries in the world that use the MM-DD-YYYY format

<center>
![map_mmddyyy](https://pbs.twimg.com/media/CEwVKWbWgAAzFS2.png)
</center>

<br>

From https://twitter.com/donohoe/status/597876118688026624.

## Left pad other numbers with zeros

<center>
![logical_order](img/01-naming/logical_order.png)
</center>

<br>

If you don’t left pad, you get this:

~~~
10_final-figs-for-publication.R
1_data-cleaning.R
2_fit-model.R
~~~

which is just sad :(

## Recap: Plays well with default ordering

- Put something numeric first
- Use the ISO 8601 standard for dates
- Left pad other numbers with zeros

## Recap: Three principles for (file) names

1. Machine readable
2. Human readable
3. Plays well with default ordering

## Pros

- Easy to implement NOW
- Payoffs accumulate as your skills evolve and projects get more complex

## Go forth and use awesome file names :)

![chronological_order](img/01-naming/chronological_order.png)

<br>

![logical_order](img/01-naming/logical_order.png)






